---
title: Filesystem Documentation
layout: documentation
---

<div class="row">
    <div class="col-md-8">
        <h1>Filesystem</h1>
        <div class="docs">
            
            <div id="createDirectory" class="docsection">
                <div>
                    <h2>
                        <a href="#createDirectory">createDirectory</a>
                    </h2>
                    
                    <p>Creates a new directory in the filesystem and returns information about the new filesystem entry.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to new directory</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>Flash page (on success); Error code (on failure)</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>Address relative to 0x4000 (on success)</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="createDirectoryEntry" class="docsection">
                <div>
                    <h2>
                        <a href="#createDirectoryEntry">createDirectoryEntry</a>
                    </h2>
                    
                    <p>Creates a new directory entry in the FAT.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Parent ID</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>Directory name</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>New entry Flash page (on success); Error code (on failure)</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>New entry address relative to 0x4000 (on success)</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="createFileEntry" class="docsection">
                <div>
                    <h2>
                        <a href="#createFileEntry">createFileEntry</a>
                    </h2>
                    
                    <p>Creates a new file entry in the FAT.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>IY</dt>
                                <dd><p>Section ID</p></dt>
                                
                                <dt>DE</dt>
                                <dd><p>Parent ID</p></dt>
                                
                                <dt>ABC</dt>
                                <dd><p>Length</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>File name</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>New entry Flash page (on success); Error code (on failure)</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>New entry address relative to 0x4000 (on success)</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="deleteFile" class="docsection">
                <div>
                    <h2>
                        <a href="#deleteFile">deleteFile</a>
                    </h2>
                    
                    <p>Deletes a file.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to file (string pointer)</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>Preserved on success, error code on failure</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set if file was deleted, reset if file did not exist</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="directoryExists" class="docsection">
                <div>
                    <h2>
                        <a href="#directoryExists">directoryExists</a>
                    </h2>
                    
                    <p>Determines if a directory exists.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to directory (string pointer)</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>Z</dt>
                                <dd><p>Set if file exists, reset if not</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="fileExists" class="docsection">
                <div>
                    <h2>
                        <a href="#fileExists">fileExists</a>
                    </h2>
                    
                    <p>Determines if a file exists.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to file (string pointer)</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>Z</dt>
                                <dd><p>Set if file exists, reset if not</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="findDirectoryEntry" class="docsection">
                <div>
                    <h2>
                        <a href="#findDirectoryEntry">findDirectoryEntry</a>
                    </h2>
                    
                    <p>Finds a directory entry in the FAT.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to directory</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Notes</h3>
                        
                            <p>This function returns HL=0 for the root directory. You should handle this special case yourself. The root directory has ID 0 and has no parent directory.</p>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>Flash page (on success); Error code (on failure)</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>Address relative to 0x4000 (on success)</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="findFileEntry" class="docsection">
                <div>
                    <h2>
                        <a href="#findFileEntry">findFileEntry</a>
                    </h2>
                    
                    <p>Finds a file entry in the FAT.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to file (string pointer)</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>Flash page (on success); Error code (on failure)</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>Address relative to 0x4000 (on success)</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="formatUnusedPages" class="docsection">
                <div>
                    <h2>
                        <a href="#formatUnusedPages">formatUnusedPages</a>
                    </h2>
                    
                    <p>If /bin/init is called with A set to 0xFF, this function should be called. It may be appropriate to show the user some sort of UI while this is processing, as it will take some time to run.</p>

                    <div class="details">
                    
                        <h3>Notes</h3>
                        
                            <p>This function is only relevant to system-level programmers. Most programmers do not have to concern themselves with it.</p>
                        
                    
                    </div>
                </div>
            </div>
            
            <div id="listDirectory" class="docsection">
                <div>
                    <h2>
                        <a href="#listDirectory">listDirectory</a>
                    </h2>
                    
                    <p>Lists the contents of a directory on the filesystem.</p>

                    <div class="details">
                    
                        <h3>Inputs</h3>
                        
                            <dl>
                                
                                <dt>DE</dt>
                                <dd><p>Path to directory</p></dt>
                                
                                <dt>HL</dt>
                                <dd><p>Callback</p></dt>
                                
                            </dl>
                        
                    
                        <h3>Notes</h3>
                        
                            <p>This function will call your callback every time it encounters a relevant entry on the filesystem. You are free to use IX, IY, and the shadow registers in this callback, but must preserve all other registers. Your function will be called with the following state: * HL: Address of entry * BC: Length of entry * A: Type of entry * kernelGarbage: Name of entry * Correct page swapped into bank A * Interrupts disabled (do not enable them) You must leave these registers intact.</p>
                        
                    
                        <h3>Outputs</h3>
                        
                            <dl>
                                
                                <dt>A</dt>
                                <dd><p>Error code on failure, preserved on success</p></dt>
                                
                                <dt>Z</dt>
                                <dd><p>Set on success, reset on failure</p></dt>
                                
                            </dl>
                        
                    
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    <div class="col-md-4">
        <div data-spy="affix">
            <h2>Filesystem Functions</h2>
            <ul class="nav doc-nav" data-offset-top="60" data-offset-bottom="200">
                
                <li>
                    <a href="#createDirectory">createDirectory</a>
                </li>
                
                <li>
                    <a href="#createDirectoryEntry">createDirectoryEntry</a>
                </li>
                
                <li>
                    <a href="#createFileEntry">createFileEntry</a>
                </li>
                
                <li>
                    <a href="#deleteFile">deleteFile</a>
                </li>
                
                <li>
                    <a href="#directoryExists">directoryExists</a>
                </li>
                
                <li>
                    <a href="#fileExists">fileExists</a>
                </li>
                
                <li>
                    <a href="#findDirectoryEntry">findDirectoryEntry</a>
                </li>
                
                <li>
                    <a href="#findFileEntry">findFileEntry</a>
                </li>
                
                <li>
                    <a href="#formatUnusedPages">formatUnusedPages</a>
                </li>
                
                <li>
                    <a href="#listDirectory">listDirectory</a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
<script type="text/javascript">

</script>